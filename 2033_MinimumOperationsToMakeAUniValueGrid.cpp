#include<bits/stdc++.h>
using namespace std;

class Solution {
public:
    int minOperations(vector<vector<int>>& grid, int x) {
        int m =grid.size(), n =grid[0].size(), minVal = grid[0][0], maxVal = grid[0][0];

        if (m==1 && n==1){
            return 0;
        }

        for (int i=0;i<m; ++i){
            for (int j=0; j<n; ++j){
                if (grid[i][j] < minVal){
                    minVal = grid[i][j];
                } else if (grid[i][j] > maxVal){
                    maxVal = grid[i][j];
                }
            }
        }      

        if ((maxVal-minVal)%x!=0)   return -1;

        int maxMultiplier = (maxVal - minVal)/x;
        vector<int> multiplierFreq(maxMultiplier+1,0);
        
        int totalOperations = 0, totalFreq=0;

        for (int i=0; i<m; ++i){
            for (int j=0; j<n; ++j){
                if ( (maxVal - grid[i][j])%x ==0 ){
                    ++multiplierFreq[(maxVal - grid[i][j])/x];
                    totalOperations += ((maxVal - grid[i][j])/x);
                    totalFreq++;
                } else {
                    return -1;
                }
            }
        }

        int minOperations = totalOperations, freqLeft =multiplierFreq[0], freqRight = totalFreq-multiplierFreq[0];
        for (int i=1; i<=maxMultiplier; ++i){
            totalOperations = totalOperations + freqLeft - freqRight;
            if (minOperations<totalOperations){
                break;
            }
            minOperations = totalOperations;
            freqLeft += multiplierFreq[i];
            freqRight -= multiplierFreq[i];
        }

        return minOperations;
    }
};

int main(){
    Solution s;
    // vector<vector<int>> grid = {{2,4}, {6,8}};
    // int x = 2;
    // cout<<s.minOperations(grid, x); // 4

    vector<vector<int>> grid = {
        {2574,2574,2574,6723,6723,2574,2574,6723,6723,2574,2574,2574,6723,6723,6723,6723,6723,6723,6723,2574,6723,2574,2574,6723,6723,2574,2574,6723,2574,2574,2574,2574,6723,6723,6723,2574,2574,2574,6723,6723,2574,2574,2574,6723,6723,2574,6723,2574,6723,6723},
        {6723,6723,2574,6723,2574,6723,2574,2574,6723,6723,2574,6723,6723,2574,2574,6723,6723,6723,2574,2574,2574,6723,6723,2574,2574,6723,2574,6723,6723,6723,6723,2574,2574,2574,2574,6723,6723,2574,2574,2574,6723,2574,2574,2574,6723,6723,2574,6723,2574,2574},
        {2574,6723,2574,6723,6723,2574,6723,2574,2574,2574,2574,6723,6723,2574,6723,6723,6723,2574,2574,2574,2574,6723,2574,2574,6723,2574,2574,6723,6723,6723,6723,6723,2574,2574,2574,6723,2574,6723,2574,2574,2574,6723,6723,2574,2574,6723,2574,2574,2574,2574},
        {2574,2574,6723,6723,2574,6723,6723,6723,6723,2574,6723,2574,6723,2574,6723,6723,2574,2574,2574,6723,6723,6723,2574,2574,6723,6723,2574,2574,6723,6723,6723,2574,2574,2574,2574,2574,2574,2574,6723,6723,2574,2574,6723,6723,6723,6723,6723,2574,2574,6723},
        {2574,6723,6723,6723,2574,2574,6723,2574,6723,6723,6723,2574,2574,6723,6723,2574,2574,2574,2574,2574,2574,2574,6723,2574,6723,2574,2574,2574,2574,6723,6723,6723,2574,2574,6723,6723,2574,6723,2574,2574,6723,6723,2574,2574,2574,2574,6723,2574,2574,6723},
        {2574,6723,2574,6723,2574,2574,2574,6723,6723,2574,2574,6723,6723,2574,6723,2574,2574,6723,2574,2574,6723,2574,2574,6723,2574,6723,2574,6723,2574,6723,2574,2574,2574,2574,6723,2574,2574,2574,2574,2574,6723,6723,2574,6723,2574,2574,2574,2574,2574,6723},
        {2574,6723,6723,6723,6723,2574,2574,6723,6723,6723,2574,6723,2574,2574,2574,2574,6723,6723,2574,6723,2574,6723,6723,6723,6723,2574,2574,2574,2574,6723,2574,6723,2574,2574,2574,6723,2574,2574,6723,2574,2574,6723,2574,6723,2574,2574,6723,6723,2574,6723},
        {6723,6723,6723,6723,6723,2574,6723,6723,6723,2574,6723,6723,2574,2574,2574,2574,6723,2574,6723,6723,6723,2574,2574,2574,6723,2574,6723,6723,2574,2574,2574,2574,6723,2574,6723,6723,2574,2574,6723,2574,6723,6723,6723,6723,2574,6723,6723,2574,2574,2574},
        {2574,6723,6723,6723,2574,6723,2574,6723,2574,6723,6723,2574,6723,2574,6723,6723,6723,2574,2574,2574,2574,2574,2574,2574,6723,2574,2574,6723,6723,6723,6723,6723,2574,6723,6723,6723,6723,2574,6723,6723,2574,6723,2574,2574,2574,6723,2574,6723,6723,6723},
        {6723,6723,6723,6723,6723,2574,2574,2574,2574,6723,2574,2574,6723,2574,6723,2574,2574,2574,6723,6723,2574,6723,2574,2574,6723,2574,6723,6723,6723,6723,6723,6723,2574,6723,2574,6723,6723,6723,2574,6723,2574,6723,2574,2574,2574,2574,6723,2574,6723,6723},
        {6723,2574,6723,6723,2574,2574,2574,2574,6723,6723,2574,2574,2574,2574,6723,6723,6723,2574,6723,2574,2574,6723,6723,6723,6723,6723,2574,6723,6723,6723,6723,6723,6723,2574,2574,6723,2574,6723,2574,2574,6723,2574,2574,6723,6723,2574,6723,2574,2574,6723},
        {6723,6723,6723,6723,6723,2574,2574,6723,2574,2574,2574,6723,2574,2574,6723,2574,2574,2574,2574,2574,2574,2574,6723,6723,2574,6723,2574,6723,2574,2574,6723,6723,6723,6723,2574,6723,2574,6723,2574,6723,6723,6723,6723,2574,2574,6723,6723,6723,2574,2574},
        {6723,2574,2574,6723,2574,2574,6723,2574,2574,6723,6723,2574,6723,6723,6723,2574,2574,6723,2574,6723,2574,6723,6723,2574,6723,6723,6723,2574,2574,6723,6723,6723,2574,2574,2574,2574,2574,6723,6723,6723,2574,2574,2574,6723,6723,6723,2574,2574,2574,2574},
        {2574,6723,2574,6723,6723,2574,6723,2574,6723,2574,6723,2574,2574,6723,6723,2574,6723,2574,2574,6723,6723,2574,2574,6723,2574,2574,6723,2574,6723,2574,6723,6723,6723,2574,6723,6723,6723,2574,6723,2574,2574,6723,2574,2574,2574,2574,2574,6723,2574,6723},
        {6723,6723,2574,6723,6723,6723,6723,6723,2574,2574,2574,2574,2574,2574,6723,2574,2574,6723,6723,2574,6723,2574,2574,6723,2574,2574,2574,6723,6723,6723,6723,2574,6723,2574,6723,6723,6723,2574,2574,6723,2574,2574,2574,2574,6723,2574,2574,6723,6723,6723},
        {6723,6723,2574,2574,2574,6723,6723,6723,6723,6723,6723,2574,2574,6723,6723,6723,2574,6723,6723,2574,2574,6723,6723,2574,6723,2574,2574,6723,6723,2574,2574,2574,2574,2574,2574,2574,2574,6723,6723,2574,6723,2574,6723,2574,2574,6723,2574,6723,6723,2574},
        {2574,2574,2574,2574,2574,2574,6723,6723,6723,6723,6723,6723,6723,2574,2574,6723,2574,6723,6723,2574,6723,2574,6723,2574,2574,6723,2574,6723,2574,2574,2574,2574,6723,6723,2574,6723,6723,6723,2574,2574,2574,6723,2574,2574,2574,2574,6723,2574,6723,2574},
        {6723,6723,6723,2574,2574,6723,2574,2574,2574,6723,6723,2574,6723,2574,6723,6723,2574,6723,2574,6723,6723,6723,6723,2574,6723,6723,2574,6723,2574,6723,2574,6723,2574,6723,2574,6723,6723,6723,2574,2574,2574,6723,2574,6723,2574,2574,2574,6723,2574,2574},
        {2574,6723,6723,6723,6723,2574,2574,2574,6723,2574,6723,6723,6723,6723,6723,2574,2574,6723,2574,6723,2574,6723,6723,2574,6723,6723,6723,2574,2574,6723,2574,2574,6723,6723,2574,2574,6723,6723,2574,2574,2574,2574,2574,6723,2574,2574,6723,2574,2574,2574},
        {6723,2574,6723,2574,2574,2574,6723,2574,6723,2574,2574,2574,6723,2574,6723,6723,2574,6723,6723,6723,6723,2574,2574,2574,2574,6723,2574,2574,6723,2574,2574,6723,2574,2574,2574,6723,6723,6723,6723,2574,2574,2574,6723,6723,6723,6723,2574,6723,2574,6723},
        {2574,6723,2574,6723,6723,2574,6723,6723,6723,6723,2574,6723,2574,2574,2574,2574,2574,2574,2574,6723,6723,6723,6723,2574,2574,2574,2574,6723,2574,2574,2574,6723,2574,6723,2574,6723,6723,6723,6723,6723,6723,6723,2574,6723,6723,2574,6723,2574,2574,2574},
        {6723,6723,2574,2574,2574,6723,6723,2574,2574,6723,6723,6723,6723,2574,6723,6723,2574,6723,6723,2574,6723,2574,6723,6723,2574,2574,6723,2574,6723,6723,2574,2574,6723,6723,2574,2574,6723,6723,2574,2574,6723,6723,2574,2574,6723,2574,2574,6723,6723,6723},
        {6723,6723,2574,6723,2574,2574,2574,2574,2574,2574,6723,6723,6723,6723,2574,6723,6723,2574,6723,2574,6723,6723,2574,6723,2574,6723,2574,6723,6723,2574,6723,6723,6723,6723,6723,6723,6723,2574,6723,2574,6723,6723,2574,2574,6723,2574,6723,6723,6723,2574},
        {6723,2574,6723,2574,6723,6723,6723,2574,2574,2574,2574,2574,6723,6723,2574,6723,6723,2574,6723,6723,6723,6723,2574,6723,6723,2574,2574,2574,2574,2574,2574,2574,6723,2574,6723,2574,2574,6723,2574,2574,2574,6723,2574,6723,6723,2574,2574,6723,2574,2574},
        {2574,6723,2574,6723,6723,6723,2574,2574,2574,2574,2574,2574,2574,6723,2574,6723,6723,6723,2574,2574,2574,6723,6723,6723,2574,6723,6723,6723,6723,6723,6723,2574,6723,2574,2574,2574,2574,2574,6723,2574,2574,6723,6723,6723,6723,6723,2574,2574,2574,2574},
        {6723,2574,6723,2574,6723,2574,2574,2574,6723,6723,6723,2574,6723,2574,2574,6723,2574,6723,6723,2574,6723,2574,2574,6723,2574,2574,6723,2574,2574,2574,6723,2574,2574,6723,2574,2574,6723,6723,2574,2574,2574,2574,2574,2574,6723,6723,6723,6723,6723,2574},
        {6723,6723,2574,6723,2574,2574,6723,6723,2574,2574,6723,2574,2574,2574,6723,6723,2574,6723,6723,6723,6723,2574,6723,6723,2574,6723,6723,6723,6723,2574,6723,2574,6723,2574,6723,2574,2574,6723,2574,6723,2574,2574,2574,2574,6723,6723,2574,2574,2574,6723},
        {6723,6723,6723,6723,2574,6723,2574,2574,2574,6723,2574,6723,2574,2574,2574,6723,6723,2574,2574,6723,2574,6723,2574,6723,2574,2574,2574,6723,2574,2574,6723,2574,6723,2574,6723,6723,6723,2574,2574,2574,6723,6723,6723,2574,6723,2574,6723,2574,6723,2574},
        {2574,2574,2574,2574,6723,2574,6723,6723,2574,6723,6723,2574,6723,2574,2574,2574,2574,2574,2574,6723,2574,6723,6723,6723,6723,6723,6723,2574,6723,2574,2574,2574,2574,2574,2574,2574,2574,2574,2574,6723,2574,6723,6723,2574,6723,6723,6723,2574,6723,2574},
        {2574,6723,2574,2574,2574,6723,2574,6723,2574,2574,6723,2574,2574,2574,2574,6723,2574,2574,2574,6723,2574,2574,6723,6723,2574,6723,6723,6723,6723,6723,2574,2574,6723,2574,6723,6723,6723,2574,6723,6723,2574,6723,2574,2574,2574,6723,6723,6723,2574,6723},
        {2574,2574,2574,2574,6723,2574,2574,6723,2574,6723,6723,2574,6723,2574,2574,2574,2574,6723,2574,2574,2574,2574,2574,6723,2574,2574,2574,2574,2574,2574,2574,6723,2574,6723,2574,6723,6723,6723,2574,2574,2574,6723,2574,6723,2574,2574,2574,2574,6723,2574},
        {6723,6723,2574,6723,6723,6723,2574,2574,2574,2574,2574,6723,6723,2574,2574,2574,2574,2574,6723,6723,2574,2574,6723,6723,2574,2574,6723,6723,6723,6723,2574,6723,2574,2574,2574,2574,6723,6723,2574,6723,6723,2574,2574,6723,2574,2574,6723,2574,6723,2574},
        {6723,6723,6723,6723,2574,6723,6723,2574,6723,6723,2574,6723,6723,2574,2574,6723,2574,2574,6723,2574,6723,2574,2574,6723,2574,6723,2574,2574,2574,2574,6723,6723,6723,2574,2574,6723,2574,2574,6723,2574,6723,2574,2574,6723,6723,6723,6723,6723,6723,6723},
        {6723,6723,2574,2574,6723,2574,6723,2574,6723,6723,2574,2574,2574,2574,2574,2574,6723,2574,2574,6723,2574,6723,2574,2574,6723,2574,6723,2574,2574,2574,2574,6723,6723,2574,2574,6723,2574,6723,2574,6723,2574,2574,2574,2574,2574,2574,2574,6723,2574,2574},
        {2574,2574,6723,2574,6723,2574,6723,6723,6723,2574,6723,2574,2574,6723,6723,2574,2574,6723,6723,6723,6723,2574,6723,2574,6723,6723,6723,6723,6723,2574,6723,2574,2574,6723,6723,6723,2574,2574,6723,6723,6723,6723,2574,2574,6723,6723,2574,2574,2574,6723},
        {6723,6723,2574,6723,2574,2574,2574,2574,6723,2574,6723,2574,2574,2574,6723,6723,6723,6723,6723,6723,6723,6723,2574,6723,2574,2574,6723,2574,6723,2574,6723,2574,6723,2574,6723,6723,2574,6723,2574,6723,2574,2574,6723,2574,6723,6723,2574,2574,6723,2574},
        {2574,2574,6723,6723,6723,2574,6723,2574,6723,6723,2574,6723,6723,6723,2574,6723,6723,2574,2574,2574,2574,2574,6723,2574,6723,6723,2574,6723,2574,2574,6723,2574,2574,6723,6723,2574,2574,6723,2574,6723,6723,6723,2574,6723,6723,6723,6723,2574,2574,6723},
        {6723,2574,6723,2574,2574,6723,6723,2574,6723,6723,6723,2574,6723,2574,6723,6723,2574,2574,6723,6723,6723,2574,6723,6723,2574,2574,2574,6723,2574,2574,2574,2574,6723,6723,6723,6723,2574,2574,6723,2574,6723,6723,2574,6723,2574,6723,2574,2574,6723,6723},
        {2574,2574,2574,2574,6723,2574,2574,2574,2574,6723,2574,6723,6723,6723,2574,2574,2574,6723,2574,6723,2574,6723,2574,2574,2574,2574,6723,6723,6723,2574,6723,2574,2574,2574,6723,2574,2574,2574,2574,6723,2574,6723,6723,6723,6723,2574,2574,2574,2574,6723},
        {6723,2574,6723,2574,6723,6723,6723,6723,2574,6723,6723,6723,2574,6723,6723,2574,2574,2574,6723,2574,6723,6723,2574,2574,6723,2574,2574,2574,6723,6723,2574,2574,6723,6723,2574,2574,2574,6723,6723,6723,6723,6723,2574,2574,6723,6723,2574,6723,6723,2574},
        {6723,2574,6723,6723,2574,6723,6723,2574,2574,2574,2574,2574,2574,2574,2574,6723,6723,2574,2574,2574,2574,6723,2574,2574,6723,6723,2574,6723,6723,6723,2574,2574,2574,6723,2574,6723,6723,2574,2574,2574,2574,6723,2574,6723,2574,2574,2574,2574,6723,6723},
        {6723,2574,2574,2574,6723,6723,6723,2574,2574,6723,2574,6723,2574,2574,2574,6723,6723,2574,6723,6723,2574,6723,6723,6723,6723,6723,6723,6723,6723,6723,2574,2574,6723,6723,6723,2574,6723,2574,2574,2574,6723,6723,2574,2574,2574,2574,6723,6723,6723,2574},
        {6723,6723,2574,6723,2574,2574,6723,2574,2574,6723,2574,6723,6723,6723,2574,6723,6723,2574,2574,2574,2574,2574,6723,2574,6723,2574,6723,2574,2574,6723,6723,2574,6723,2574,2574,2574,2574,6723,6723,6723,6723,2574,2574,2574,6723,6723,6723,6723,6723,6723},
        {2574,6723,2574,6723,6723,2574,2574,2574,2574,6723,2574,2574,6723,6723,6723,6723,2574,2574,6723,6723,2574,6723,2574,6723,6723,2574,2574,2574,6723,6723,2574,2574,2574,2574,6723,2574,2574,2574,2574,2574,2574,2574,6723,6723,2574,6723,6723,6723,2574,2574},
        {6723,2574,2574,2574,6723,2574,6723,6723,6723,6723,2574,2574,2574,6723,6723,6723,2574,6723,6723,6723,2574,2574,2574,6723,2574,2574,6723,6723,2574,6723,2574,2574,6723,6723,2574,2574,6723,6723,2574,6723,2574,2574,2574,6723,2574,2574,6723,6723,2574,2574},
        {6723,6723,2574,2574,2574,6723,6723,2574,6723,6723,2574,6723,6723,2574,2574,2574,6723,2574,6723,6723,2574,2574,6723,2574,2574,2574,6723,6723,6723,6723,2574,6723,2574,2574,2574,6723,6723,2574,2574,6723,6723,6723,6723,6723,6723,6723,6723,6723,2574,6723},
        {6723,2574,6723,2574,6723,2574,2574,2574,2574,2574,2574,2574,2574,6723,2574,6723,2574,6723,2574,6723,6723,2574,2574,2574,2574,6723,6723,2574,6723,6723,6723,6723,6723,2574,2574,2574,6723,6723,2574,2574,2574,6723,2574,6723,2574,6723,2574,2574,2574,6723},
        {2574,2574,2574,6723,6723,6723,6723,2574,6723,2574,2574,2574,2574,6723,6723,6723,6723,2574,2574,2574,6723,6723,6723,6723,2574,6723,6723,2574,6723,2574,2574,6723,6723,6723,6723,6723,6723,2574,2574,6723,6723,6723,2574,2574,6723,2574,2574,2574,6723,2574},
        {2574,2574,6723,6723,6723,2574,6723,6723,6723,6723,2574,6723,2574,6723,6723,2574,2574,6723,6723,2574,6723,6723,6723,6723,6723,6723,2574,6723,2574,6723,6723,2574,6723,2574,6723,2574,6723,6723,6723,2574,2574,2574,6723,6723,2574,2574,6723,6723,6723,2574},
        {6723,2574,6723,6723,6723,2574,6723,6723,6723,6723,2574,2574,2574,2574,6723,6723,6723,6723,6723,6723,6723,6723,6723,6723,6723,6723,6723,6723,2574,2574,6723,6723,6723,6723,6723,2574,6723,6723,2574,6723,2574,6723,6723,2574,2574,6723,2574,2574,6723,6723}};
    int x = 4149;
    cout<<s.minOperations(grid, x); // 1234
    return 0;
}


/*
Input: grid = [[1,5],[2,3]], x = 1
Output: 5

freq = [1,0,1,1,1]

i=0, FreqLeft = 0, FreqRight =4, totalOperations = 0 + 2 + 3 + 4 = 9
i=1, FreqLeft = 1, FreqRight =3, totalOperations = 9 -3 + 1 = 7
i=2, FreqLeft = 1, FreqRight =3, totalOperations = 7 -3 + 1 = 5
i=3, FreqLeft = 2, FreqRight =2, totalOperations = 5 -2 + 2 = 5
i=4, FreqLeft = 3, FreqRight =1, totalOperations = 5 -1 + 3 = 7 

ans = 5
*/